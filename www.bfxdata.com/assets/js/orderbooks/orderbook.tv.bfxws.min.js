function moveElements(e){if(992>=e){var t=$("#ratioChartsColom").detach();t.removeClass(),t.addClass("col-xs-4"),t.appendTo("#secondRow");var a=$("#tradesPanelCol").detach();a.removeClass(),a.addClass("col-xs-8"),a.appendTo("#secondRow");var o=$("#orderBookTablesCol").detach();o.removeClass(),o.addClass("col-xs-12"),o.appendTo("#fourthRow");var r=$("#lastTradesChartCol").removeClass();r.addClass("col-xs-12");var s=$("#depthChartCol").removeClass();s.addClass("col-xs-12")}if(e>992){var t=$("#ratioChartsColom").detach();t.removeClass(),t.addClass("col-xs-2"),t.prependTo("#thirdRow");var s=$("#depthChartCol").removeClass();s.addClass("col-xs-6");var o=$("#orderBookTablesCol").detach();o.removeClass(),o.addClass("col-xs-4"),o.appendTo("#thirdRow");var r=$("#lastTradesChartCol").removeClass();r.addClass("col-xs-8");var a=$("#tradesPanelCol").detach();a.removeClass(),a.addClass("col-xs-4"),a.appendTo("#topRow")}if(e>1366){var t=$("#ratioChartsColom");t.removeClass(),t.addClass("col-xs-2");var s=$("#depthChartCol").removeClass();s.addClass("col-xs-7");var o=$("#orderBookTablesCol");o.removeClass(),o.addClass("col-xs-3");var r=$("#lastTradesChartCol").removeClass();r.addClass("col-xs-9");var a=$("#tradesPanelCol");a.removeClass(),a.addClass("col-xs-3")}}function tickerResize(e){768>e&&($("#ticker").empty(),$("#ticker").load("../assets/include/ticker_3rows.html")),e>=768&&1280>e&&($("#ticker").empty(),$("#ticker").load("../assets/include/ticker_2rows.html")),e>=1280&&1366>e&&($("#ticker").empty(),$("#ticker").load("../assets/include/ticker_1row.html")),e>=1366&&($("#ticker").empty(),$("#ticker").load("../assets/include/ticker_1row.html")),setTimeout(function(){tickersReceived={BTCUSD:!1,LTCUSD:!1,ETCUSD:!1,ETHUSD:!1,ZECUSD:!1,ZECUSD:!1,XMRUSD:!1,RRTUSD:!1,LTCBTC:!1,ETCBTC:!1,ETHBTC:!1,ZECBTC:!1,XMRBTC:!1,BFXBTC:!1,RRTBTC:!1}},1e3)}function footerFirstload(e){if(1280>e&&$("#footerContainer").load("../assets/include/divFooterSmall.php"),e>=1280&&$("#footerContainer").load("../assets/include/divFooterBig.php"),1366>e)var t="305px",a="295px";else var t="415px",a="415px";$("#tradesTableDiv").slimscroll({height:t,width:"100%"}),$("#asksTableDiv").slimscroll({height:a,width:"100%"}),$("#bidsTableDiv").slimscroll({height:a,width:"100%"})}function footerResize(e){if(1280>e&&previousWidth>=1280&&$("#footerContainer").load("../assets/include/divFooterSmall.php"),e>=1280&&1280>previousWidth&&$("#footerContainer").load("../assets/include/divFooterBig.php"),1366>e)var t="305px",a="295px";else var t="415px",a="415px";$("#tradesTableDiv").slimscroll({height:t,width:"100%"}),$("#asksTableDiv").slimscroll({height:a,width:"100%"}),$("#bidsTableDiv").slimscroll({height:a,width:"100%"})}function makeOrderbooktables(){var e=' 	<div> 	  <table class=" table table-condensed table-hover" id="trades"> 		<tbody id="tradesTableBody"> 		</tbody> 	</div> 	</table> 	';document.getElementById("tradesTableDiv").innerHTML=e,$("#tradesTableDiv").slimscroll({height:"415px",width:"100%"});var t=' 			<div> 			  <table class=" table table-condensed table-hover" id="asks"> 				<tbody id="asksTableBody"> 				</tbody> 			</table> 	</div> 	';document.getElementById("asksTableDiv").innerHTML=t,$("#asksTableDiv").slimscroll({height:"415px",width:"100%"});var a=' 			<div> 			  <table class=" table table-condensed table-hover" id="bids"> 				<tbody id="bidsTableBody"> 				</tbody> 			</table> 	</div> 	';document.getElementById("bidsTableDiv").innerHTML=a,$("#bidsTableDiv").slimscroll({height:"415px",width:"100%"});var o=' 			<div> 			  <table class=" table table-condensed " id="volume1hTable"> 				<tbody id="volume1hTableBody"> 				</tbody> 			</table> 	</div> 	';document.getElementById("volume1hTableDiv").innerHTML=o;var r=' 			<div> 			  <table class=" table table-condensed " id="volume24hTable"> 				<tbody id="volume24hTableBody"> 				</tbody> 			</table> 	</div> 	';document.getElementById("volume24hTableDiv").innerHTML=r,ajaxVolumeTables()}function ajaxVolumeTables(){urlVolume1Hour="../json/sellBuyVolumesLastHour"+orderbookSymbol+".json",urlVolume24Hour="../json/sellBuyVolumes24Hour"+orderbookSymbol+".json",ajaxNewVolume1HourJson(urlVolume1Hour),ajaxNewVolume24HourJson(urlVolume24Hour),volumeTableFirstLoad=!1}function ajaxNewVolume1HourJson(urlVolume1Hour){$.ajax({url:urlVolume1Hour,type:"GET",dataType:"json",timeout:3e3,cache:!1,success:function(data){data=eval(data),makeVolume1hTable(data)},error:function(e,t,a){"timeout"===t?console.log(urlVolume1Hour+" timeout"):console.log("Error: "+urlVolume1Hour+" || "+t)}})}function ajaxNewVolume24HourJson(urlVolume24Hour){$.ajax({url:urlVolume24Hour,type:"GET",dataType:"json",timeout:3e3,cache:!1,success:function(data){data=eval(data),makeVolume24hTable(data)},error:function(e,t,a){"timeout"===t?console.log(urlVolume24Hour+" timeout"):console.log("Error: "+urlVolume24Hour+" || "+t)}})}function startwebsocketio(){var url="https://"+window.location.hostname+":3001";socket=io.connect(url,{secure:!0});var channels=["orderbook"+orderbookSymbol,"bfxdataToday","bfxdataToday1Minute","sellBuyRatio24Hour"+orderbookSymbol,"sellBuyRatioLastHour"+orderbookSymbol,"sellBuyVolumes24Hour"+orderbookSymbol,"sellBuyVolumesLastHour"+orderbookSymbol];socket.on("connect",function(){socket.emit("adduser",randomUsername()),channels.forEach(function(e){socket.emit("switchChannel",e)})}),socket.on("dataupdate",function(username,data){try{jsonObject=data,jsonObject=JSON.parse(jsonObject)}catch(ex){}try{var keyname=Object.keys(jsonObject);"ticker_rt"==keyname&&(data=jsonObject[keyname]),"bfxdataToday"!=keyname&&"bfxdataToday1Minute"!=keyname||(data=jsonObject[keyname],updateValues(data)),keyname=="sellBuyVolumesLastHour"+orderbookSymbol&&(data=jsonObject[keyname],volumeTableFirstLoad||(data=eval(data),makeVolume1hTable(data))),keyname=="sellBuyVolumes24Hour"+orderbookSymbol&&(data=jsonObject[keyname],volumeTableFirstLoad||(data=eval(data),makeVolume24hTable(data))),keyname=="sellBuyRatioLastHour"+orderbookSymbol&&(data=jsonObject[keyname],data=eval(data),lastHourRatioChart.series[0].setData(data,!0,!0,!0)),keyname=="sellBuyRatio24Hour"+orderbookSymbol&&(data=jsonObject[keyname],data=eval(data),last24HourRatioChart.series[0].setData(data,!0,!0,!0))}catch(ex){}})}function randomUsername(){for(var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",t=8,a="user_",o=0;t>o;o++){var r=Math.floor(Math.random()*e.length);a+=e.substring(r,r+1)}str=window.location.href,str=str.replace("https://www.bfxdata.com/",""),str=str.replace("https://bfxdata.com/",""),str=str.replace("http://www.bfxdata.com/",""),str=str.replace("http://bfxdata.com/",""),str=str.replace(/\//g,"_"),a+="_"+str;var s=new Date,n=s.getTime();return a+="_"+n}function updateTickerValue(e,t,a){var o="#"+e;t=parseFloat(t);var r=e.substr(e.length-6);switch(r){case"BTCUSD":var s=2;break;case"ETHUSD":var s=4;break;case"ETCUSD":var s=4;break;case"LTCUSD":var s=4;break;case"ZECUSD":var s=4;break;case"XMRUSD":var s=4;break;case"BFXUSD":var s=4;break;case"RRTUSD":var s=4;break;case"ETHBTC":var s=6;break;case"ETCBTC":var s=6;break;case"LTCBTC":var s=6;break;case"ZECBTC":var s=6;break;case"XMRBTC":var s=6;break;case"BFXBTC":var s=6;break;case"RRTBTC":var s=6}"up"==a&&(tickerLoaded&&($(o).css("color","green"),$(o).animate({backgroundColor:"rgba(90,151,112,0.3)"},300),$(o).animate({backgroundColor:"rgba(255,255,255,0)"},3e3)),$(o).html(formatTickerNumber(t,s))),"down"==a&&(tickerLoaded&&($(o).css("color","red"),$(o).animate({backgroundColor:"rgba(204,63,51,0.3)"},300),$(o).animate({backgroundColor:"rgba(255,255,255,0)"},3e3)),$(o).html(formatTickerNumber(t,s))),"same"==a&&(tickerLoaded&&$(o).css("color","rgb(55, 77, 108)"),$(o).html(formatTickerNumber(t,s)))}function formatTickerNumber(e,t){e=e.toFixed(t)+"",x=e.split("."),x1=x[0],x2=x.length>1?"."+x[1]:"";for(var a=/(\d+)(\d{3})/;a.test(x1);)x1=x1.replace(a,"$1,$2");return x1+x2}function bfxdataToday(){$.ajax({url:"../json/bfxdataToday.json",type:"GET",dataType:"json",timeout:3e3,cache:!1,success:function(data){data=eval(data),updateValues(data)},error:function(e,t,a){"timeout"===t?console.log("Statstabale timeout"):console.log("Error: "+t)}})}function bfxdataToday1minute(){$.ajax({url:"../json/bfxdataToday1Minute.json",type:"GET",dataType:"json",timeout:3e3,cache:!1,success:function(data){data=eval(data),updateValues(data),bfxdataTodayloaded=!0},error:function(e,t,a){"timeout"===t?console.log("Statstabale 1m timeout"):console.log("Error: "+t)}})}function updateValue(e,t){var a="#"+e;t=parseFloat(t);for(var o=$(a).text();-1!=o.indexOf(",");)o=o.replace(",","");o=parseFloat(o);var r=e.substr(0,e.length-6),s=e.substr(0,e.length-3);if(e=="min"+orderbookSymbol||e=="max"+orderbookSymbol||e=="vwap24"+orderbookSymbol||e=="change24abs"+orderbookSymbol)var n=orderbookPriceDecimals;else if("buyPercentage"==r||"change24rel"==r||"volumeChange"==r)var n=orderbookSumDecimals;else if("todayVolume"==r||"volumeWeek"==r||"volumeMonth"==r)var n=0;else var n=5;t=formatNumber(t,n),t=t.split(",").join(""),t=parseFloat(t),t>o&&(bfxdataTodayloaded&&($(a).parent().animate({backgroundColor:"rgba(90,151,112,0.3)"},300),$(a).parent().animate({backgroundColor:"rgba(255,255,255,0)"},3e3)),"change24rel"==s||"volumeChange"==s||"lastSwapUSD"==e||"lastSwapBTC"==e||"lastSwapLTC"==e?$(a).html(formatNumber(t,n)+" %"):$(a).html(formatNumber(t,n))),o>t&&(bfxdataTodayloaded&&($(a).parent().animate({backgroundColor:"rgba(204,63,51,0.3)"},300),$(a).parent().animate({backgroundColor:"rgba(255,255,255,0)"},3e3)),"change24rel"==s||"volumeChange"==s||"lastSwapUSD"==e||"lastSwapBTC"==e||"lastSwapLTC"==e?$(a).html(formatNumber(t,n)+" %"):$(a).html(formatNumber(t,n))),"change24rel"!=s&&"volumeChange"!=s&&"change24abs"!=s&&"changeAbsoluteTotalAmountUSD"!=e&&"changeAbsoluteTotalAmountBTC"!=e&&"changeAbsoluteTotalAmountLTC"!=e&&"changeAbsoluteTotalAvgRateUSD"!=e&&"changeAbsoluteTotalAvgRateBTC"!=e&&"changeAbsoluteTotalAvgRateLTC"!=e||changeFontColor(a,t)}function updateValues(e){jQuery.each(e,function(e,t){updatedValue=t[0],updateValue(e,updatedValue)})}function changeFontColor(e,t){t>0&&$(e).css("color","green"),0>t&&$(e).css("color","red")}function formatNumber(e,t){e=e.toFixed(t)+"",x=e.split("."),x1=x[0],x2=x.length>1?"."+x[1]:"";for(var a=/(\d+)(\d{3})/;a.test(x1);)x1=x1.replace(a,"$1,$2");return x1+x2}function startTime(){var e=new Date,t=e.getUTCHours(),a=e.getMinutes(),o=e.getSeconds();t=checkTime(t),a=checkTime(a),o=checkTime(o);try{document.getElementById("clock").innerHTML=t+":"+a+":"+o+" (UTC)&nbsp &nbsp &nbsp;"}catch(r){}setTimeout(function(){startTime()},500)}function checkTime(e){return 10>e&&(e="0"+e),e}function makeVolume1hTable(e){$("#volume1hTableBody").empty();var t=parseFloat(e[2]),a=parseFloat(e[1]),o=parseFloat(e[0]);$("#volume1hTableBody").append("<tr><td class='volumTableLabel'>Sell</td><td class='volumTableValue'>"+formatNumber(o,4)+"</td></tr><tr><td class='volumTableLabel'>Buy</td><td class='volumTableValue'>"+formatNumber(a,4)+"</td></tr><tr><td class='volumTableLabel'>Total</td><td class='volumTableValue'>"+formatNumber(t,4)+"</td></tr>")}function makeVolume24hTable(e){$("#volume24hTableBody").empty();var t=parseFloat(e[2]),a=parseFloat(e[1]),o=parseFloat(e[0]);$("#volume24hTableBody").append("<tr><td class='volumTableLabel'>Sell</td><td class='volumTableValue'>"+formatNumber(o,4)+"</td></tr><tr><td class='volumTableLabel'>Buy</td><td class='volumTableValue'>"+formatNumber(a,4)+"</td></tr><tr><td class='volumTableLabel'>Total</td><td class='volumTableValue'>"+formatNumber(t,4)+"</td></tr>")}function mergeSort(e){if(e.length>1){var t=e.slice(0,e.length/2),a=e.slice(e.length/2);return t=mergeSort(t),a=mergeSort(a),merge(t,a)}return e}function merge(e,t){for(var a=[],o=0;e.length||t.length;)o=e.length&&t.length?e[0]<t[0]?e.shift():t.shift():e.length?e.shift():t.shift(),$.inArray(o,a)<0&&a.push(o);return a}function formatNumber(e,t){e=e.toFixed(t)+"",x=e.split("."),x1=x[0],x2=x.length>1?"."+x[1]:"";for(var a=/(\d+)(\d{3})/;a.test(x1);)x1=x1.replace(a,"$1,$2");return x1+x2}function timeConverter(e){var t=new Date(1e3*e),a=(t.getFullYear(),t.getMonth(),t.getDate(),t.getUTCHours());10>a&&(a="0"+a);var o=t.getMinutes();10>o&&(o="0"+o);var r=t.getSeconds();10>r&&(r="0"+r);var s=a+":"+o+":"+r;return s}function tsToDate(e){var t=new Date(e),a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],o=t.getFullYear(),r=t.getMonth(),s=t.getDate(),n=t.getUTCHours();10>n&&(n="0"+n);var i=t.getMinutes();10>i&&(i="0"+i);var l=t.getSeconds();10>l&&(l="0"+l);var d=n+":"+i+":"+l+" "+s+"-"+a[r]+"-"+o;return d}function startBfxWebSocket(){websocket=new WebSocket(wsUri),websocket.onopen=function(e){onOpen(e)},websocket.onclose=function(e){onClose(e)},websocket.onmessage=function(e){onMessage(e)},websocket.onerror=function(e){onError(e)}}function startBfxWebSocketV2(){var e="wss://api.bitfinex.com/ws/2";wsv2=new WebSocket(e),wsv2.onopen=function(e){onOpenV2(e)},wsv2.onclose=function(e){onClose(e)},wsv2.onmessage=function(e){onMessageV2(e)},wsv2.onerror=function(e){onError(e)}}function onOpen(e){console.log("CONNECTED"),subBook(orderbookSymbol,"P0","100"),subTrades(orderbookSymbol);for(var t=["BTCUSD","LTCUSD","LTCBTC","ETHBTC","ETHUSD","ETCBTC","ETCUSD","ZECBTC","ZECUSD","XMRBTC","XMRUSD","RRTBTC","RRTUSD","BFXBTC","BFXUSD"],a=0;a<t.length;a++)subTicker(t[a])}function onOpenV2(e){console.log("CONNECTED V2");var t=candleIntervalSelected,a="trade:"+t+":t"+orderbookSymbol;subCandles(a)}function onClose(e){console.log("DISCONNECTED")}function onMessage(e){if(data=JSON.parse(e.data),data.hasOwnProperty("event")){var t=data.event;if("subscribed"==t){var a={},o=data.chanId;a.name=data.channel,a.pair=data.pair,channelIDs[o]=a}}else{var r=data[0],s=channelIDs[r].name,n=channelIDs[r].pair;if(!isHeartBeat(data))switch(s){case"trades":isSnapshot(data)?parseTradesSnapshot(data):"te"==data[1]&&parseTradeUpdate(data);break;case"book":isSnapshot(data)?parseBookSnapshot(data):parseBookUpdate(data);break;case"ticker":var i={tickerPrice:data[7]};if(tickersReceived[n])compareTick(i,n);else{tickersReceived[n]=!0,tickerValues[n]=i;var l="tickerPrice"+n;updateTickerValue(l,data[7],"same")}break;default:console.log("unknown channel ID: "+r+" Channel Name: "+s)}}}function onMessageV2(e){if(data=JSON.parse(e.data),data.hasOwnProperty("event")){var t=data.event;if("subscribed"==t){var a={},o=data.chanId;a.name=data.channel;var r=data.key;a.key=r;var s=r.split(":"),n=s[2];n=n.substr(n.length-6,n.length),a.pair=n,a.interval=s[1],channelIDsV2[o]=a}}else try{var i=data[0],l=channelIDsV2[i].name;channelIDsV2[i].key;if(!isHeartBeat(data)&&"number"==typeof data[1][0])switch(l){case"candles":allowNewCandles&&parseCandle(data)}}catch(d){}}function onError(e){}function doSend(e){websocket.send(e)}function writeToScreen(e){var t=document.createElement("p");t.style.wordWrap="break-word",t.innerHTML=e,output.appendChild(t)}function subBook(e,t,a){var o=JSON.stringify({event:"subscribe",channel:"book",pair:e,prec:t,len:a});websocket.send(o)}function unsubscribe(e){allowBookUpdates=!1;var t=JSON.stringify({event:"unsubscribe",chanId:e});websocket.send(t),delete channelIDs[e]}function unsubscribeV2(e){allowNewCandles=!1;var t=JSON.stringify({event:"unsubscribe",chanId:e});wsv2.send(t),delete channelIDsV2[e]}function switchCandleInterval(e){var t=getChannelIDV2("candles",orderbookSymbol,candleIntervalSelected);unsubscribeV2(t);var a="trade:"+e+":t"+orderbookSymbol;subCandles(a),candleIntervalSelected=e,allowNewCandles=!0}function changePrecision(){graphMarketDepth.xAxis[0].setExtremes(null,null);var e=document.getElementById("precisionSelector");e=e.value;var t=100,a=getChannelID(orderbookSymbol,"book");unsubscribe(a),subBook(orderbookSymbol,e,t),checkMinMaxZoom()}function subTicker(e){var t=JSON.stringify({event:"subscribe",channel:"ticker",pair:e});websocket.send(t)}function subCandles(e){var t=JSON.stringify({event:"subscribe",channel:"candles",key:e});wsv2.send(t)}function subTrades(e){var t=JSON.stringify({event:"subscribe",channel:"trades",pair:e});websocket.send(t)}function isSnapshot(e){return Array.isArray(e[1])}function isHeartBeat(e){return"hb"==e[1]}function compareTick(e,t){var a=tickerValues[t];for(var o in e)if(e.hasOwnProperty(o)&&e[o]!==a[o]){if(e[o]>a[o])var r="up";if(e[o]<a[o])var r="down";tickerValues[t][o]=e[o];var s=o+t;updateTickerValue(s,e[o],r)}}function parseTradesSnapshot(e){var t=e[1],a=(e[0],!1);t.reverse();for(var o=0,r=t.length;r>o;o++){var s=t[o][2],n=t[o][3],i=t[o][1];addTradeRow(s,n,i,a)}}function parseTradeUpdate(e){var t=e[4],a=e[5],o=e[3],r=!0;addTradeRow(t,a,o,r)}function addTradeRow(e,t,a,o){var r=e;if(t>0)var s="buy";else{var s="sell";t=-1*t}var n=orderbookPriceDecimals,i=orderbookAmountDecimals;if("buy"==s)if(o){var l="<tr style='font-weight: bold;'><td class='td_price' >"+formatNumber(r,n)+"</td><td class='td_amount' >"+formatNumber(t,i)+"</td><td class='td_type' style='color:green;'>"+s+"</td><td class='td_timestamp'>"+timeConverter(a)+"</td></tr>";$(l).hide().slideDown(3400,function(){$(this).css("font-weight","300")}).prependTo("#tradesTableBody")}else $("#tradesTableBody").prepend("<tr><td class='td_price' >"+formatNumber(r,n)+"</td><td class='td_amount' >"+formatNumber(t,i)+"</td><td class='td_type' style='color:green;'>"+s+"</td><td class='td_timestamp'>"+timeConverter(a)+"</td></tr>");if("sell"==s)if(o){var l="<tr style='font-weight: bold;'><td class='td_price' >"+formatNumber(r,n)+"</td><td class='td_amount' >"+formatNumber(t,i)+"</td><td class='td_type' style='color:red;'>"+s+"</td><td class='td_timestamp'>"+timeConverter(a)+"</td></tr>";$(l).hide().slideDown(3400,function(){$(this).css("font-weight","300")}).prependTo("#tradesTableBody")}else $("#tradesTableBody").prepend("<tr><td class='td_price' >"+formatNumber(r,n)+"</td><td class='td_amount' >"+formatNumber(t,i)+"</td><td class='td_type' style='color:red;'>"+s+"</td><td class='td_timestamp'>"+timeConverter(a)+"</td></tr>");var d=orderbookSymbol.substr(orderbookSymbol.length-3);"USD"==d?$(document).attr("title","$"+r+" "+orderbookSymbol+" | BFXdata.com"):$(document).attr("title",r+" "+orderbookSymbol+" | BFXdata.com"),lastTradePrice=r}function parseBookSnapshot(e){orderBookData.bids={},orderBookData.asks={},oldBidsObject={},oldAsksObject={};for(var t=e[1],a=(e[0],0),o=t.length;o>a;a++){var r=t[a][0],s=t[a][1],n=t[a][2];n>0&&(orderBookData.bids[r]=[n,s]),0>n&&(orderBookData.asks[r]=[-n,s])}allowBookUpdates=!0,printOrderBook(!0)}function getChannelID(e,t){for(var a in channelIDs)if(channelIDs.hasOwnProperty(a)){var o=channelIDs[a].name,r=channelIDs[a].pair;if(o==t&&r==e)return a}return console.log("no match found"),0}function getChannelIDV2(e,t,a){"undefined"==typeof a&&(a="not_set");for(var o in channelIDsV2)if(channelIDsV2.hasOwnProperty(o)){var r=channelIDsV2[o].name,s=channelIDsV2[o].pair;if("not_set"!=a){var n=channelIDsV2[o].interval;return r==e&&s==t&&n==a?o:0}if(r==e&&s==t)return o}return console.log("no match found"),0}function compareOldNewBook(e,t){var a={};for(var o in t)if(t.hasOwnProperty(o)){var r=t[o][0],s=t[o][1];if(e.hasOwnProperty(o)){var n=e[o][0];if(n==r)var i=0;else if(n>r)var i=1;else if(r>n)var i=2}else var i=3;a[o]=[r,s,i]}for(var o in e)if(e.hasOwnProperty(o)&&!t.hasOwnProperty(o)){var n=e[o][0],l=e[o][1],i=4;a[o]=[n,l,i]}return a}function printOrderBook(e){var t=orderBookData.bids,a=orderBookData.asks,o=[],r=[];for(var s in t)t.hasOwnProperty(s)&&(amount=t[s][0],count=t[s][1],o.push([parseFloat(s),amount]));for(var s in a)a.hasOwnProperty(s)&&(amount=a[s][0],count=a[s][1],r.push([parseFloat(s),amount]));o.sort(sortOrderbook),o.reverse(),r.sort(sortOrderbook),updateDepthTable(o,"bids",e),updateDepthTable(r,"asks",e)}function parseBookUpdate(e){channelID=e[0];var t=e[1],a=e[2],o=e[3];0==a?(delete orderBookData.bids[t],delete orderBookData.asks[t]):(o>0&&(orderBookData.bids[t]=[o,a]),0>o&&(orderBookData.asks[t]=[-o,a]))}function parseCandle(e){var t=[e[1][0],e[1][1],e[1][3],e[1][4],e[1][2],e[1][5]],a=t[0],o=lastCandle[0],r=lastCandle[5],s=t[5];a>o&&(allowNewCandles=!1,addLastPoint(t)),a==o&&s>r&&(allowNewCandles=!1,updateLastPoint(t))}function orderbookUpdater(){allowBookUpdates&&printOrderBook(!1),orderbookUpdateTimer=setTimeout(function(){orderbookUpdater()},updateFreq)}function stopOrderbookUpdater(){clearTimeout(orderbookUpdateTimer)}function changeUpdateFreq(){stopOrderbookUpdater();var e=document.getElementById("updateFreqSel");e=parseInt(e.value),updateFreq=e,orderbookUpdater(),console.log(updateFreq)}function updateDepthTable(e,t,a){var o=[],r="";if("bids"==t)var s="#bidsTableBody",n="rgba(90,151,112,0.2)";if("asks"==t)var s="#asksTableBody",n="rgba(204,63,51,0.2)";$(s).empty();var i=0,l=0,d=[];jQuery.each(e,function(e,t){var a=t[0],o=t[1];o>l&&(l=o),i+=o,d.push([a,o,i])});jQuery.each(d,function(e,a){var i=a[0],d=a[1],c=a[2],u=100*d/l,h=orderbookPriceDecimals,m=orderbookAmountDecimals,A=orderbookSumDecimals;if(o.push([i,c]),status=0,"asks"==t)var p="position: absolute; background: "+n+"; width: "+u+"%;  height: 100%;";if("bids"==t)var p="position: absolute; right: 0px; background: "+n+"; width: "+u+"%;  height: 100%;";switch(parseInt(status)){case 0:r+="<tr><td><div style= 'position: relative;'><div style='"+p+"'></div><div class='div_price' style='display: inline-block;'> "+formatNumber(i,h)+"</div><div class='div_amount' style='display: inline-block;'>"+formatNumber(d,m)+"</div><div class='div_sum'style='display: inline-block;'>"+formatNumber(c,A)+"</div></div></td></tr>";break;case 1:$(s).append("<tr><td class='td_price'>"+formatNumber(i,h)+"</td><td class='td_amount amount_depth_minus'>"+formatNumber(d,m)+"</td><td class='td_sum'>"+formatNumber(c,A)+"</td></tr>");break;case 2:$(s).append("<tr><td class='td_price'>"+formatNumber(i,h)+"</td><td class='td_amount amount_depth_plus'>"+formatNumber(d,m)+"</td><td class='td_sum'>"+formatNumber(c,A)+"</td></tr>");break;case 3:$(s).append("<tr class='added_depth_tr'><td class='td_price'><div class='new_depth_table_entry'>"+formatNumber(i,h)+"</div></td><td class='td_amount'><div class='new_depth_table_entry'>"+formatNumber(d,m)+"</div></td><td class='td_sum'><div class='new_depth_table_entry'>"+formatNumber(c,A)+"</td></tr>");break;case 4:$(s).append("<tr class='removed_depth_tr'><td class='td_price'><div class='removed_depth_table_entry'>"+formatNumber(i,h)+"</div></td><td class='td_amount'><div class='removed_depth_table_entry'>"+formatNumber(d,m)+"</div></td><td class='td_sum'><div class='removed_depth_table_entry'> - </div></td></tr>")}}),$(s).append(r),$(".div_price").css("width","20%"),$(".div_amount").css("width","40%"),$(".div_sum").css("width","40%"),$(".removed_depth_table_entry").css("text-decoration","line-through"),setTimeout(function(){$(".removed_depth_table_entry").slideUp(500)},1e3),setTimeout(function(){$(".removed_depth_tr").remove()},1500),$(".amount_depth_plus").css("color","green"),$(".amount_depth_minus").css("color","red"),$(".amount_depth_plus").css("font-weight","bold"),$(".amount_depth_minus").css("font-weight","bold"),$(".new_depth_table_entry").css("font-weight","bold"),$(".new_depth_table_entry").hide(),setTimeout(function(){$(".new_depth_table_entry").slideDown(500)},1),setTimeout(function(){$(".new_depth_table_entry").css("font-weight","300")},1900),setTimeout(function(){$(".amount_depth_plus").css("font-weight","300")},1900),setTimeout(function(){$(".amount_depth_minus").css("font-weight","300")},1900),setTimeout(function(){$(".amount_depth_plus").css("color","#666666")},1900),setTimeout(function(){$(".amount_depth_minus").css("color","#666666")},1900),"bids"==t?(bidsDepthChartLoaded=!0,bidsDepthChart=o,highestBid=o[0][0],lowestBid=o[o.length-1][0],o.reverse(),a||(graphMarketDepth.series[0].setData(bidsDepthChart,!0,!0,!0),checkMinMaxZoom()),a&&(minZoom=.99*highestBid)):(asksDepthChartLoaded=!0,asksDepthChart=o,lowestAsk=o[0][0],highestAsk=o[o.length-1][0],a||(graphMarketDepth.series[1].setData(asksDepthChart,!0,!0,!0),checkMinMaxZoom()),a&&(maxZoom=1.1*lowestAsk)),"undefined"==typeof graphMarketDepth&&bidsDepthChartLoaded&&asksDepthChartLoaded&&(createDepthChart(bidsDepthChart,asksDepthChart),checkMinMaxZoom())}function checkMinMaxZoom(){var e=!1;lowestBid>=minZoom&&(minZoom=lowestBid,e=!0),maxZoom>=highestAsk&&(maxZoom=highestAsk,e=!0),e&&graphMarketDepth.xAxis[0].setExtremes(minZoom,maxZoom)}function sortOrderbook(e,t){return e[0]===t[0]?0:parseFloat(e[0])<parseFloat(t[0])?-1:1}function createDepthChart(e,t){lowestBid=e[0][0],highestBid=e[e.length-1][0],lowestAsk=t[0][0],highestAsk=t[t.length-1][0],maxZoom=lowestAsk*(1+.01*depthZoomPercentageMultiplier),minZoom=highestBid*(1-.01*depthZoomPercentageMultiplier),Highcharts.setOptions({global:{useUTC:!0}}),graphMarketDepth=new Highcharts.Chart({chart:{renderTo:"marketDepthChart",type:"area",animation:!1,spacingTop:-10,spacingBottom:0,spacingLeft:0,spacingRight:0,zoomType:"x",panning:!0,panKey:"shift",events:{load:function(){this.xAxis[0].setExtremes(minZoom,maxZoom)}},resetZoomButton:{theme:{display:"none"}}},navigation:{enabled:!1,buttonOptions:{verticalAlign:"top",x:-60,y:-127}},credits:{enabled:!1},title:{text:"",style:{display:"none"}},xAxis:{gridLineWidth:1,lineWidth:1,minorTickInterval:"auto",minorTickColor:"#FEFEFE",title:{enabled:!1,text:"Price "+orderbookSymbol,style:{fontWeight:"normal",display:"none"}}},yAxis:{gridLineWidth:1,minorTickInterval:"auto",minorTickColor:"#FEFEFE",opposite:!0,labels:{align:"left",x:5,y:0,enabled:!0},title:{enabled:!1,text:"Volume Sum",style:{fontWeight:"normal",display:"none"}}},legend:{align:"center",verticalAlign:"top",y:10,floating:!0,backgroundColor:"#FFFFFF",shadow:!0,enabled:!1},plotOptions:{series:{lineWidth:1,animation:!1,marker:{enabled:!1}}},tooltip:{crosshairs:[!0,!0],formatter:function(){var e="Sum: "+formatNumber(this.y,orderbookSumDecimals);return e+="<br/>Price: "+this.x}},series:[{name:"Bids",id:"bids",data:e,color:"rgba(90,151,112,1.0)",fillColor:"rgba(90,151,112,0.2)"},{name:"Asks",id:"asks",data:t,color:"rgba(204,63,51,1.0)",fillColor:"rgba(204,63,51,0.2)"}]})}var socket,tickerLoaded=!0,previousWidth,bfxdataTodayloaded=!1,volumeTableFirstLoad=!0,lastTID,tradesOld,tradesCurrent,tradesNew,orderbookUpdateTimer,lastTradePrice=0,allowBookUpdates,allowNewCandles=!1,orderBookData={bids:{},asks:{}},oldBidsObject={},oldAsksObject={},bidsDepthChartLoaded=!1,asksDepthChartLoaded=!1,bidsDepthChart,asksDepthChart,updateFreq=2e3,settings_dialog,tickerValues={},tickersReceived={BTCUSD:!1,LTCUSD:!1,ETCUSD:!1,ETHUSD:!1,ZECUSD:!1,ZECUSD:!1,XMRUSD:!1,RRTUSD:!1,LTCBTC:!1,ETCBTC:!1,ETHBTC:!1,ZECBTC:!1,XMRBTC:!1,BFXBTC:!1,RRTBTC:!1},loadCandles=!1,candleIntervalSelected="1m",wsUri="wss://api2.bitfinex.com:3000/ws",channelIDs={},channelIDsV2={},cycles=0,debug=!1,lastDepthChartUpdate=0,lastBookOrderCheck=0,candlePairs=["RRTUSD","RRTBTC","ZECUSD","ZECBTC","XMRUSD","XMRBTC"];$.inArray(orderbookSymbol,candlePairs)>-1&&(loadCandles=!0),$(document).ready(function(){var e=$(window).width();bfxdataToday(),bfxdataToday1minute(),makeOrderbooktables(),startBfxWebSocket(),loadCandles&&startBfxWebSocketV2(),orderbookUpdater(),tickerResize(e),footerFirstload(e),startwebsocketio(e),moveElements(e),settings_dialog=$("#settings_dialog").dialog({autoOpen:!1,title:"Orderbook Settings",width:300}),previousWidth=e,startTime()}),$(window).resize(function(){var e=$(window).width();e!==previousWidth&&(tickerResize(e),footerResize(e),moveElements(e),previousWidth=e)});var graphMarketDepth,minZoom,maxZoom,lowestAsk,lowestBid,highestAsk,highestBid;$("#zoomOut").click(function(){minZoom-=.02*highestBid*depthZoomPercentageMultiplier,maxZoom+=.02*lowestAsk*depthZoomPercentageMultiplier,lowestBid>=minZoom&&(minZoom=lowestBid),maxZoom>=highestAsk&&(maxZoom=highestAsk),graphMarketDepth.xAxis[0].setExtremes(minZoom,maxZoom),graphMarketDepth.yAxis[0].setExtremes(null,null)}),$("#zoomIn").click(function(){minZoom+=.01*highestBid*depthZoomPercentageMultiplier,maxZoom-=.01*lowestAsk*depthZoomPercentageMultiplier,graphMarketDepth.xAxis[0].setExtremes(minZoom,maxZoom),graphMarketDepth.yAxis[0].setExtremes(null,null)});var lastHourRatioChart;$(function(){$.getJSON("../json/sellBuyRatioLastHour"+orderbookSymbol+".json",function(e){Highcharts.setOptions({colors:["rgba(204,63,51,0.8)","rgba(90,151,112,0.8)"]}),lastHourRatioChart=new Highcharts.Chart({chart:{renderTo:"ratioChart1h",plotBackgroundColor:null,plotBorderWidth:0,plotShadow:!1,animation:!0,spacingTop:-100,spacingBottom:0,spacingLeft:30,spacingRight:30,backgroundColor:"rgba(255, 255, 255, 0)"},title:{text:"Sell / Buy Ratio (24h)",align:"center",verticalAlign:"middle",style:{fontSize:"130%",display:"none"},y:-60},exporting:{enabled:!1},credits:{enabled:!1},tooltip:{pointFormat:"<b>{point.percentage:.1f}%</b>"},plotOptions:{pie:{dataLabels:{enabled:!0,distance:-20,style:{color:"white"}},animation:!0,startAngle:-90,endAngle:90,center:["50%","75%"]}},series:[{type:"pie",name:"Buy / Sell Ratio",innerSize:"50%",data:e}]})})});var last24HourRatioChart;$(function(){$.getJSON("../json/sellBuyRatio24Hour"+orderbookSymbol+".json",function(e){Highcharts.setOptions({colors:["rgba(204,63,51,0.8)","rgba(90,151,112,0.8)"]}),last24HourRatioChart=new Highcharts.Chart({chart:{renderTo:"ratioChart24h",plotBackgroundColor:null,plotBorderWidth:0,plotShadow:!1,animation:!0,spacingTop:-100,spacingBottom:0,spacingLeft:30,spacingRight:30,backgroundColor:"rgba(255, 255, 255, 0)"},title:{text:"Sell / Buy Ratio (24h)",align:"center",verticalAlign:"middle",style:{fontSize:"130%",display:"none"},y:-60},exporting:{enabled:!1},credits:{enabled:!1},tooltip:{pointFormat:"<b>{point.percentage:.1f}%</b>"},plotOptions:{pie:{dataLabels:{enabled:!0,distance:-20,style:{color:"white"}},animation:!0,startAngle:-90,endAngle:90,center:["50%","75%"]}},series:[{type:"pie",name:"Buy / Sell Ratio",innerSize:"50%",data:e}]})})}),function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports&&t(require("jquery"),e),"function"==typeof define?define.cmd?define(function(a,o,r){var s=a("jquery");t(s,e)}):define(["jquery"],function(a){t(a,e)}):t(e.jQuery,e)}("undefined"!=typeof window?window:this,function(e,t,a){"use strict";function o(t,a){a=a||{},this.dom=t,this.options=e.extend(!0,{},o.defaultOptions,a),this.curtain=null,this.render().show()}if(e||(e=t.jQuery||null),!e)throw new TypeError("必须引入jquery库方可正常使用！");var r=Array.prototype.slice,s=function(e,t){var a=!0;for(var o in e)if(e[o]!==t[e]){a=!0;break}return a};o.prototype={constructor:o,initElement:function(){var t=this.dom,a=this.options,o=t.children(".mloading"),r=o.children(".mloading-body"),s=r.children(".mloading-bar"),n=s.children(".mloading-icon"),i=s.find(".mloading-text");if(0==o.length&&(o=e('<div class="mloading"></div>'),t.append(o)),0==r.length&&(r=e('<div class="mloading-body"></div>'),o.append(r)),0==s.length&&(s=e('<div class="mloading-bar"></div>'),r.append(s)),0==n.length){var l=document.createElement(a.iconTag);n=e(l),n.addClass("mloading-icon"),s.append(n)}return 0==i.length&&(i=e('<span class="mloading-text"></span>'),s.append(i)),this.curtainElement=o,this.bodyElement=r,this.barElement=s,this.iconElement=n,this.textElement=i,this},render:function(){var e=this.dom,t=this.options;return this.initElement(),e.is("html")||e.is("body")?this.curtainElement.addClass("mloading-full"):(this.curtainElement.removeClass("mloading-full"),e.hasClass("mloading-container")||e.addClass("mloading-container")),t.mask?this.curtainElement.addClass("mloading-mask"):this.curtainElement.removeClass("mloading-mask"),""!=t.content&&"undefined"!=typeof t.content?t.html?this.bodyElement.html(t.content):this.bodyElement.text(t.content):(this.iconElement.attr("src",t.icon),t.html?this.textElement.html(t.text):this.textElement.text(t.text)),this},setOptions:function(t){t=t||{};var a=this.options;this.options=e.extend(!0,{},this.options,t),s(a,this.options)||this.render()},show:function(){var e=(this.dom,this.options,this.barElement);return this.curtainElement.addClass("active"),
e.css({marginTop:"-"+e.outerHeight()/2+"px",marginLeft:"-"+e.outerWidth()/2+"px"}),this},hide:function(){var e=this.dom;this.options;return this.curtainElement.removeClass("active"),e.is("html")||e.is("body")||e.removeClass("mloading-container"),this},destroy:function(){var e=this.dom;this.options;return this.curtainElement.remove(),e.is("html")||e.is("body")||e.removeClass("mloading-container"),e.removeData(o.dataKey),this}},o.dataKey="MLoading",o.defaultOptions={text:"Loading...",iconTag:"img",icon:"data:image/gif;base64,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",html:!1,content:"",mask:!1},e.fn.mLoading=function(t){var a={},s="",n=[];return"object"==typeof t?a=t:"string"==typeof t&&(s=t,n=r.call(arguments).splice(0,1)),this.each(function(t,r){var i=e(r),l=i.data(o.dataKey);if(l||(l=new o(i,a)),s){var d=l[s];"function"==typeof d&&d.apply(l,n)}})}}),function(e){jQuery.fn.extend({slimScroll:function(a){var o={width:"auto",height:"250px",size:"7px",color:"#000",position:"right",distance:"1px",start:"top",opacity:0,alwaysVisible:!1,disableFadeOut:!1,railVisible:!1,railColor:"#333",railOpacity:0,railDraggable:!0,railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:!1,wheelStep:20,touchScrollStep:200,borderRadius:"7px",railBorderRadius:"7px"},r=e.extend(o,a);return this.each(function(){function o(t){if(c){var t=t||window.event,a=0;t.wheelDelta&&(a=-t.wheelDelta/120),t.detail&&(a=t.detail/3);var o=t.target||t.srcTarget||t.srcElement;e(o).closest("."+r.wrapperClass).is(T.parent())&&s(a,!0),t.preventDefault&&!k&&t.preventDefault(),k||(t.returnValue=!1)}}function s(e,t,a){k=!1;var o=e,s=T.outerHeight()-B.outerHeight();if(t&&(o=parseInt(B.css("top"))+e*parseInt(r.wheelStep)/100*B.outerHeight(),o=Math.min(Math.max(o,0),s),o=e>0?Math.ceil(o):Math.floor(o),B.css({top:o+"px"})),b=parseInt(B.css("top"))/(T.outerHeight()-B.outerHeight()),o=b*(T[0].scrollHeight-T.outerHeight()),a){o=e;var n=o/T[0].scrollHeight*T.outerHeight();n=Math.min(Math.max(n,0),s),B.css({top:n+"px"})}T.scrollTop(o),T.trigger("slimscrolling",~~o),l(),d()}function n(){window.addEventListener?(this.addEventListener("DOMMouseScroll",o,!1),this.addEventListener("mousewheel",o,!1),this.addEventListener("MozMousePixelScroll",o,!1)):document.attachEvent("onmousewheel",o)}function i(){p=Math.max(T.outerHeight()/T[0].scrollHeight*T.outerHeight(),f),B.css({height:p+"px"});var e=p==T.outerHeight()?"none":"block";B.css({display:e})}function l(){if(i(),clearTimeout(m),b==~~b){if(k=r.allowPageScroll,v!=b){var e=0==~~b?"top":"bottom";T.trigger("slimscroll",e)}}else k=!1;return v=b,p>=T.outerHeight()?void(k=!0):(B.stop(!0,!0).fadeIn("fast"),void(r.railVisible&&S.stop(!0,!0).fadeIn("fast")))}function d(){r.alwaysVisible||(m=setTimeout(function(){r.disableFadeOut&&c||u||h||(B.fadeOut("slow"),S.fadeOut("slow"))},1e3))}var c,u,h,m,A,p,b,v,g="<div></div>",f=30,k=!1,T=e(this);if(T.parent().hasClass(r.wrapperClass)){var y=T.scrollTop();if(B=T.parent().find("."+r.barClass),S=T.parent().find("."+r.railClass),i(),e.isPlainObject(a)){if("height"in a&&"auto"==a.height){T.parent().css("height","auto"),T.css("height","auto");var C=T.parent().parent().height();T.parent().css("height",C),T.css("height",C)}else if("height"in a){var w=a.height;T.parent().css("height",w),T.css("height",w)}if("scrollTo"in a)y=parseInt(r.scrollTo);else if("scrollBy"in a)y+=parseInt(r.scrollBy);else if("destroy"in a)return B.remove(),S.remove(),void T.unwrap();s(y,!1,!0)}}else{r.height="auto"==r.height?T.parent().height():r.height;var x=e(g).addClass(r.wrapperClass).css({position:"relative",overflow:"hidden",width:r.width,height:r.height});T.css({overflow:"hidden",width:r.width,height:r.height});var S=e(g).addClass(r.railClass).css({width:r.size,height:"100%",position:"absolute",top:0,display:r.alwaysVisible&&r.railVisible?"block":"none","border-radius":r.railBorderRadius,background:r.railColor,opacity:r.railOpacity,zIndex:90}),B=e(g).addClass(r.barClass).css({background:r.color,width:r.size,position:"absolute",top:0,opacity:r.opacity,display:r.alwaysVisible?"block":"none","border-radius":r.borderRadius,BorderRadius:r.borderRadius,MozBorderRadius:r.borderRadius,WebkitBorderRadius:r.borderRadius,zIndex:99}),D="right"==r.position?{right:r.distance}:{left:r.distance};S.css(D),B.css(D),T.wrap(x),T.parent().append(B),T.parent().append(S),r.railDraggable&&B.bind("mousedown",function(a){var o=e(document);return h=!0,t=parseFloat(B.css("top")),pageY=a.pageY,o.bind("mousemove.slimscroll",function(e){currTop=t+e.pageY-pageY,B.css("top",currTop),s(0,B.position().top,!1)}),o.bind("mouseup.slimscroll",function(e){h=!1,d(),o.unbind(".slimscroll")}),!1}).bind("selectstart.slimscroll",function(e){return e.stopPropagation(),e.preventDefault(),!1}),S.hover(function(){l()},function(){d()}),B.hover(function(){u=!0},function(){u=!1}),T.hover(function(){c=!0,l(),d()},function(){c=!1,d()}),T.bind("touchstart",function(e,t){e.originalEvent.touches.length&&(A=e.originalEvent.touches[0].pageY)}),T.bind("touchmove",function(e){if(k||e.originalEvent.preventDefault(),e.originalEvent.touches.length){var t=(A-e.originalEvent.touches[0].pageY)/r.touchScrollStep;s(t,!0),A=e.originalEvent.touches[0].pageY}}),i(),"bottom"===r.start?(B.css({top:T.outerHeight()-B.outerHeight()}),s(0,!0)):"top"!==r.start&&(s(e(r.start).position().top,null,!0),r.alwaysVisible||B.hide()),n()}}),this}}),jQuery.fn.extend({slimscroll:jQuery.fn.slimScroll})}(jQuery);